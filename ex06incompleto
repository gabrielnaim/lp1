#include <stdio.h>

/* 6) Um motorista acaba de retornar de um feriado prolongado. Em cada parada de reabastecimento ele
registrou a leitura de seu odômetro, a quantidade de gasolina comprada (suponha que ele tenha enchido o tanque cada vez)
e o preço pago. Além disso, suponha também que ele tenha enchido o tanque antes de partir e imediatamente após retornar.
Escreva um programa em C para ler, em primeiro lugar, o número total de reabastecimentos feitos
(incluindo o primeiro e o último) e, a seguir, os dados relativos à compra de gasolina e calcular :
a) a quilometragem obtida por litro de gasolina entre cada par de paradas de reabastecimento;
b) a quilometragem obtida por litro de gasolina em toda a viagem
c) custo do combustível por quilometro rodado em toda a viagem */


struct Parada {
  float odometro;
  float abastecimento;
  float litros;
  float litrosTotal;
  float valor;
};

int main(void) {
  int n;
  printf("Numero de abastecimentos: ");
  scanf("%d", &n);

  struct Parada parada[n];

  void lerParadas(struct Parada parada[], int n);
  void calculaKmplTrajeto(struct Parada parada[], int n);

  lerParadas(parada, n);
  calculaKmplTrajeto(parada, n);
  

}

void lerParadas(struct Parada parada[], int n){
  int i;
  if (n == 2){
    printf("Quantidade de gasolina inicial no tanque em litros: ");
    scanf("%f", &parada[0].litros);
    printf("Abastecimento inicial em litros: ");
    scanf("%f", &parada[0].abastecimento);
    printf("Valor gasto inicial em Real: ");
    scanf("%f", &parada[0].valor);
    printf("Odometro inicial em quilometros: ");
    scanf("%f", &parada[0].odometro);
    parada[0].litrosTotal = parada[0].abastecimento + parada[0].litros;

    printf("Quantidade de gasolina final no tanque em litros: ");
    scanf("%f", &parada[n-1].litros);
    printf("Abastecimento final em litros: ");
    scanf("%f", &parada[n-1].abastecimento);
    printf("Valor gasto final em Real: ");
    scanf("%f", &parada[n-1].valor);
    printf("Odometro final em quilometros: ");
    scanf("%f", &parada[n-1].odometro);
     parada[n-1].litrosTotal = parada[n-1].abastecimento + parada[n-1].litros;

  } else{
    printf("Quantidade de gasolina inicial no tanque em litros: ");
    scanf("%f", &parada[0].litros);
    printf("Abastecimento inicial em litros: ");
    scanf("%f", &parada[0].abastecimento);
    printf("Valor gasto inicial em Real: ");
    scanf("%f", &parada[0].valor);
    printf("Odometro inicial em quilometros: ");
    scanf("%f", &parada[0].odometro);
    parada[0].litrosTotal = parada[0].abastecimento + parada[0].litros;

    for (i = 1; i < (n-1); i++){
      printf("Quantidade de litros na parada %d: ", i);
      scanf("%f", &parada[i].litros);
      printf("Abastecimento na parada %d em litros: ", i);
      scanf("%f", &parada[i].abastecimento);
      printf("Valor gasto na parada %d em Real: ", i);
      scanf("%f", &parada[i].valor);
      printf("Odometro na parada %d em quilometros: ", i);
      scanf("%f", &parada[i].odometro);
      parada[i].litrosTotal = parada[i].abastecimento + parada[i].litros;
    }

    printf("Quantidade de gasolina final no tanque em litros: ");
    scanf("%f", &parada[n-1].litros);
    printf("Abastecimento final em litros: ");
    scanf("%f", &parada[n-1].abastecimento);
    printf("Valor gasto final em Real: ");
    scanf("%f", &parada[n-1].valor);
    printf("Odometro final em quilometros: ");
    scanf("%f", &parada[n-1].odometro);
    parada[n-1].litrosTotal = parada[n-1].abastecimento + parada[n-1].litros;
  }
}


void calculaKmplTrajeto(struct Parada parada[], int n){
  int i;
  float kmplTrajeto[n-1];
  
  if(n == 2){
    kmplTrajeto[i] = (parada[1].odometro - parada[0].odometro)/(parada[0].litrosTotal - parada[1].litros);

    for (i = 0; i < n-1; i++){
      printf("Trajeto Abastecimento %d --> Abastecimento %d: %.2fkm/l\n", i, (i+1), kmplTrajeto[i]);
    }
  } else{
    for (i = 0; i < n-1; i++){
      kmplTrajeto[i] = (parada[i+1].odometro - parada[i].odometro)/(parada[i].litrosTotal - parada[i+1].litros);
    }

    for (i = 0; i < n-1; i++){
      printf("Trajeto Abastecimento %d --> Abastecimento %d: %.2fkm/l\n", i, (i+1), kmplTrajeto[i]);
    }
    
  }

  float kmplTotal = 0;

  if(n == 2){
    kmplTotal = ((kmplTrajeto[0] + kmplTrajeto[1])/2);
  } else {
    for (i = 0; i < n-1; i++){
      kmplTotal += kmplTrajeto[i];
    }

    kmplTotal = kmplTotal/(n-1);
  }

  printf("Media de Km/l: %.2f\n", kmplTotal);

}
